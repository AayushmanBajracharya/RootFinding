<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Root Finding Methods Quiz</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #1a1a2e;
            color: #fff;
            overflow: hidden;
        }

        /* Main container styles */
        .container {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            z-index: 1;
            background: #1a1a2e;
            overflow: hidden;
        }

        .quiz-container {
            background: rgba(31, 41, 55, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 1.5rem;
            width: 100%;
            max-width: 1200px;
            height: calc(100vh - 3rem);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            box-sizing: border-box;
        }

        /* Timer styles */
        .timer-container {
            display: flex;
            justify-content: center;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 2;
        }

        .timer {
            font-size: 1.1rem;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.1);
            color: #4cd137;
            padding: 0.35rem 1.25rem;
            border-radius: 50px;
            transition: all 0.3s ease;
            min-width: 80px;
            text-align: center;
        }

        .timer.warning {
            color: #ffa502;
            animation: pulse-warning 1s infinite;
        }

        .timer.danger {
            color: #ff4757;
            animation: pulse-warning 0.5s infinite;
            background: rgba(255, 71, 87, 0.1);
        }

        @keyframes pulse-warning {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Progress bar */
        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            height: 8px;
            border-radius: 999px;
            margin: 1.5rem 0;
            overflow: hidden;
        }

        .progress {
            background: linear-gradient(90deg, #4cd137, #45b631);
            height: 100%;
            border-radius: 999px;
            transition: width 0.3s ease;
        }

        /* Question container */
        .question-container {
            display: none;
            flex-direction: column;
            gap: 1.5rem;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            padding: 1rem;
            flex: 1;
            overflow-y: auto;
        }

        .question-container.active {
            opacity: 1;
            transform: translateY(0);
            display: flex;
        }

        .question {
            font-size: 1.2rem;
            font-weight: 600;
            color: #fff;
            line-height: 1.5;
            margin-bottom: 1rem;
            text-align: center;
        }

        /* Options styling */
        .options {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            margin: 0 auto;
            width: 100%;
            max-width: 600px;
            margin-bottom: 1rem;
        }

        .option {
            background: rgba(255, 255, 255, 0.05);
            padding: 0.8rem 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.95rem;
            color: #e2e8f0;
            position: relative;
            overflow: hidden;
            user-select: none;
            transform: translateX(0);
            transition: all 0.2s ease;
        }

        .option:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: #4cd137;
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.2s ease;
        }

        .option:not(.selected):hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .option:not(.selected):hover:before {
            transform: scaleX(1);
        }

        .option.selected {
            background: rgba(76, 209, 55, 0.15);
            border-color: #4cd137;
            transform: translateX(5px);
        }

        .option.selected:before {
            transform: scaleX(1);
        }

        .option.correct {
            background: rgba(76, 209, 55, 0.2) !important;
            border-color: #4cd137 !important;
        }

        .option.wrong {
            background: rgba(255, 71, 87, 0.2) !important;
            border-color: #ff4757 !important;
        }

        .option.disabled {
            pointer-events: none;
        }

        /* Feedback styling */
        .feedback {
            margin: 1rem 0;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .feedback.correct {
            background: rgba(76, 209, 55, 0.1);
            border: 1px solid rgba(76, 209, 55, 0.3);
            color: #4cd137;
        }

        .feedback.wrong {
            background: rgba(255, 71, 87, 0.1);
            border: 1px solid rgba(255, 71, 87, 0.3);
            color: #ff4757;
        }

        /* Navigation styling */
        .navigation {
            display: flex;
            justify-content: flex-end;
            margin-top: 1rem;
            padding-top: 1rem;
        }

        /* Button styles */
        .nav-btn {
            background: linear-gradient(135deg, #4cd137, #45b631);
            color: #fff;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 999px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            letter-spacing: 0.5px;
            max-width: 200px;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(76, 209, 55, 0.3);
        }

        .quit-btn {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.2);
            padding: 0.75rem 1.25rem;
            border-radius: 999px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quit-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: translateY(-1px);
        }

        /* Set info styles */
        .set-info {
            text-align: center;
            font-size: 1.25rem;
            color: #9ca3af;
            margin-bottom: 1.5rem;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        /* Countdown styles */
        .countdown-container {
            text-align: center;
            display: none;
            opacity: 0;
            transform: scale(0.95);
            transition: all 0.5s ease;
            padding: 2rem;
        }

        .countdown-container.active {
            display: block;
            opacity: 1;
            transform: scale(1);
        }

        .countdown-number {
            font-size: 6rem;
            font-weight: 800;
            background: linear-gradient(135deg, #4cd137, #45b631);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        .countdown-message {
            font-size: 1.75rem;
            color: #fff;
            margin-bottom: 1rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .countdown-subtext {
            color: #9ca3af;
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Score container */
        .score-container {
            text-align: center;
            display: none;
            opacity: 0;
            transform: scale(0.95);
            transition: all 0.5s ease;
            padding: 2rem;
        }

        .score-container.active {
            display: block;
            opacity: 1;
            transform: scale(1);
        }

        .score {
            font-size: 5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #4cd137, #45b631);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 1.5rem 0;
        }

        .score-message {
            color: #9ca3af;
            font-size: 1.1rem;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .progress-info {
            color: #9ca3af;
            margin-top: 1.5rem;
            font-size: 1rem;
            letter-spacing: 0.5px;
        }

        /* Particles container */
        .particles-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: #1a1a2e;
        }

        /* Animations */
        .pulse {
            animation: pulse 0.5s ease;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Responsive adjustments */
        @media (max-width: 640px) {
            .quiz-container {
                padding: 1rem;
                margin: 0.5rem;
                height: calc(100vh - 1rem);
            }

            .countdown-number {
                font-size: 4rem;
            }

            .countdown-message {
                font-size: 1.1rem;
            }

            .question {
                font-size: 1.1rem;
            }

            .option {
                padding: 0.7rem 1rem;
                font-size: 0.9rem;
            }
            
            .nav-btn {
                padding: 0.7rem 1.5rem;
                font-size: 0.9rem;
            }
        }

        /* Quit Dialog Styles */
        .quit-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .quit-dialog.active {
            display: flex;
            opacity: 1;
        }

        .quit-dialog-content {
            background: rgba(31, 41, 55, 0.95);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            max-width: 400px;
            width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s ease;
        }

        .quit-dialog.active .quit-dialog-content {
            transform: scale(1) translateY(0);
        }

        /* Cute Character Styles */
        .cute-character {
            margin-bottom: 1.5rem;
        }

        .character-face {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            border-radius: 50%;
            margin: 0 auto 1rem;
            position: relative;
            animation: bob 2s ease-in-out infinite;
        }

        @keyframes bob {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .eyes {
            display: flex;
            justify-content: space-between;
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
        }

        .eye {
            width: 12px;
            height: 16px;
            background: #fff;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            position: relative;
            overflow: hidden;
        }

        .pupil {
            width: 6px;
            height: 8px;
            background: #2d3436;
            border-radius: 50%;
            position: absolute;
            top: 6px;
            left: 3px;
            animation: blink 4s infinite;
        }

        @keyframes blink {
            0%, 95%, 100% { transform: scaleY(1); }
            97% { transform: scaleY(0.1); }
        }

        .sparkle {
            width: 2px;
            height: 2px;
            background: #fff;
            border-radius: 50%;
            position: absolute;
            top: 7px;
            left: 4px;
            animation: sparkle 2s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.2); }
        }

        .mouth {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
        }

        .mouth-curve {
            width: 20px;
            height: 10px;
            border: 2px solid #e17055;
            border-top: none;
            border-radius: 0 0 20px 20px;
            animation: smile 3s ease-in-out infinite;
        }

        @keyframes smile {
            0%, 100% { transform: scaleX(1); }
            50% { transform: scaleX(1.1); }
        }

        .blush {
            width: 8px;
            height: 6px;
            background: rgba(225, 112, 85, 0.3);
            border-radius: 50%;
            position: absolute;
            top: 35px;
        }

        .left-blush {
            left: 8px;
        }

        .right-blush {
            right: 8px;
        }

        .character-body {
            position: relative;
        }

        .heart {
            font-size: 1.5rem;
            animation: heartbeat 1.5s ease-in-out infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Dialog Text Styles */
        .quit-title {
            color: #fff;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #4cd137, #45b631);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .quit-message {
            color: #9ca3af;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 2rem;
        }

        .quit-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .stay-btn, .leave-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .stay-btn {
            background: linear-gradient(135deg, #4cd137, #45b631);
            color: #fff;
        }

        .stay-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(76, 209, 55, 0.3);
        }

        .leave-btn {
            background: rgba(255, 71, 87, 0.1);
            color: #ff4757;
            border: 1px solid rgba(255, 71, 87, 0.3);
        }

        .leave-btn:hover {
            background: rgba(255, 71, 87, 0.2);
            transform: translateY(-2px);
        }

        /* Character hover effects */
        .character-face:hover {
            animation-duration: 0.5s;
        }

        .character-face:hover .eye {
            animation-duration: 0.5s;
        }
    </style>
</head>
<body>
    <div id="particles-js" class="particles-container"></div>

    <div class="container">
        <div class="quiz-container">
            <button class="quit-btn" onclick="showQuitConfirmation()">
                <i data-lucide="x-circle"></i>
                Quit Quiz
            </button>
            
            <div class="timer-container">
                <div class="timer">30s</div>
            </div>
            
            <div class="progress-bar">
                <div class="progress" style="width: 0%"></div>
            </div>

            <div id="countdown-container" class="countdown-container active">
                <div class="countdown-number">10</div>
                <div class="countdown-message">Get ready to test your knowledge of Root Finding Methods!</div>
                <div class="countdown-subtext">This comprehensive quiz covers Bisection, Newton-Raphson, and Secant Methods. Take a deep breath and trust your preparation. You've got this! 🌟</div>
            </div>

            <div id="set-info" class="set-info" style="display: none;">
                Set <span id="current-set">1</span> of <span id="total-sets">5</span>
            </div>

            <div id="question-container" class="question-container">
                <div class="question"></div>
                <div class="options"></div>
                <div class="feedback"></div>
                <div class="navigation">
                    <button id="submit-btn" class="nav-btn">Submit Answer</button>
                </div>
            </div>

            <div id="score-container" class="score-container">
                <h2>Set Complete!</h2>
                <div class="score">0%</div>
                <p class="score-message"></p>
                <button id="next-set-btn" class="nav-btn">Start Next Set</button>
                <p class="progress-info">Your overall progress: <span id="overall-progress">0</span>%</p>
            </div>

            <!-- Quit Confirmation Dialog -->
            <div id="quit-dialog" class="quit-dialog">
                <div class="quit-dialog-content">
                    <div class="cute-character">
                        <div class="character-face">
                            <div class="eyes">
                                <div class="eye left-eye">
                                    <div class="pupil"></div>
                                    <div class="sparkle"></div>
                                </div>
                                <div class="eye right-eye">
                                    <div class="pupil"></div>
                                    <div class="sparkle"></div>
                                </div>
                            </div>
                            <div class="mouth">
                                <div class="mouth-curve"></div>
                            </div>
                            <div class="blush left-blush"></div>
                            <div class="blush right-blush"></div>
                        </div>
                        <div class="character-body">
                            <div class="heart">💚</div>
                        </div>
                    </div>
                    <h3 class="quit-title">Wait! Don't go yet! 🥺</h3>
                    <p class="quit-message">
                        You're doing amazing! I believe in you! 
                        <br>Maybe just one more question? Pretty please? 🌟
                    </p>
                    <div class="quit-buttons">
                        <button class="stay-btn" onclick="hideQuitConfirmation()">
                            <i data-lucide="heart"></i>
                            I'll Stay! 💪
                        </button>
                        <button class="leave-btn" onclick="confirmQuit()">
                            <i data-lucide="door-open"></i>
                            I Must Go 😢
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        // Quiz state variables
        let currentQuestion = 0;
        let score = 0;
        let timeLeft = 30;
        let timer = null;
        let countdownTimer = null;
        let selectedAnswer = null;
        let totalScore = 0;
        let questionsAnswered = 0;
        let currentSet = 0;
        const questionsPerSet = 9;
        const totalSets = 5;
        let questions = [];
        let allQuestions = [];

        // Helper function to create questions
        function createQuestion(question, options, correctIndex, explanation, method) {
            return {
                question: question,
                options: options,
                correct: correctIndex,
                explanation: explanation,
                method: method
            };
        }

        // All quiz questions
        allQuestions = [
            // Bisection Method Questions
            createQuestion(
                "What is the key requirement for the Bisection Method?",
                [
                    "Function must be linear",
                    "Function values must have opposite signs at endpoints",
                    "Function must be differentiable",
                    "Function must be polynomial"
                ],
                1,
                "Bisection Method requires opposite signs at endpoints to guarantee a root in the interval.",
                "Bisection"
            ),
            createQuestion(
                "What is the error reduction rate in Bisection Method?",
                [
                    "Reduces by 1/3 each iteration",
                    "Reduces by 1/2 each iteration",
                    "Reduces by 1/4 each iteration",
                    "Reduces exponentially"
                ],
                1,
                "In Bisection Method, the error is halved with each iteration.",
                "Bisection"
            ),
            createQuestion(
                "How many iterations are needed in Bisection to reduce error by factor of 1000?",
                [
                    "5 iterations",
                    "10 iterations",
                    "15 iterations",
                    "20 iterations"
                ],
                1,
                "Since 2¹⁰ ≈ 1024, 10 iterations are needed to reduce error by factor of approximately 1000.",
                "Bisection"
            ),

            // Newton-Raphson Questions
            createQuestion(
                "What can cause Newton-Raphson Method to fail?",
                [
                    "Function is too simple",
                    "Derivative is zero at an iteration",
                    "Function is continuous",
                    "Interval is too small"
                ],
                1,
                "When the derivative becomes zero, Newton-Raphson Method fails due to division by zero.",
                "Newton"
            ),
            createQuestion(
                "What does Newton-Raphson Method use to find better approximations?",
                [
                    "Midpoints of intervals",
                    "Tangent lines at points",
                    "Average of endpoints",
                    "Random points"
                ],
                1,
                "Newton-Raphson Method uses tangent lines to find intersections with x-axis as next approximations.",
                "Newton"
            ),
            createQuestion(
                "How do multiple roots affect Newton-Raphson convergence?",
                [
                    "No effect",
                    "Reduces convergence rate",
                    "Improves convergence",
                    "Prevents convergence"
                ],
                1,
                "Multiple roots reduce Newton-Raphson's convergence rate from quadratic to linear.",
                "Newton"
            ),

            // Secant Method Questions
            createQuestion(
                "How does Secant Method approximate derivatives?",
                [
                    "Using tangent lines",
                    "Using difference quotients of two points",
                    "Using integrals",
                    "Using polynomials"
                ],
                1,
                "Secant Method uses difference quotients of two points to approximate derivatives.",
                "Secant"
            ),
            createQuestion(
                "What is the convergence rate of Secant Method?",
                [
                    "Linear (1.0)",
                    "Superlinear (≈1.618)",
                    "Quadratic (2.0)",
                    "Cubic (3.0)"
                ],
                1,
                "Secant Method has superlinear convergence with rate approximately equal to the golden ratio (1.618).",
                "Secant"
            ),
            createQuestion(
                "When is Secant Method particularly useful?",
                [
                    "With polynomials only",
                    "When derivatives are hard to compute",
                    "With linear functions",
                    "With simple functions"
                ],
                1,
                "Secant Method is particularly useful when derivative calculations are difficult or costly.",
                "Secant"
            ),

            // Comparison Questions
            createQuestion(
                "Which method guarantees convergence if initial conditions are met?",
                [
                    "Newton-Raphson Method",
                    "Bisection Method",
                    "Secant Method",
                    "All of the above"
                ],
                1,
                "The Bisection Method always converges when initial conditions (opposite signs at endpoints) are met.",
                "Comparison"
            ),
            createQuestion(
                "Which method has the fastest convergence rate?",
                [
                    "Bisection Method",
                    "Newton-Raphson Method",
                    "Secant Method",
                    "They all converge at the same rate"
                ],
                1,
                "Newton-Raphson Method has quadratic convergence, which is faster than both Bisection (linear) and Secant (≈1.618) methods.",
                "Comparison"
            ),
            createQuestion(
                "Which method is computationally least expensive per iteration?",
                [
                    "Newton-Raphson Method",
                    "Bisection Method",
                    "Secant Method",
                    "All have same cost"
                ],
                1,
                "Bisection Method only requires function evaluations, making it computationally simpler per iteration.",
                "Comparison"
            ),

            // General Questions
            createQuestion(
                "What is the main advantage of bracketing methods?",
                [
                    "Fast convergence",
                    "Guaranteed convergence",
                    "Simple derivatives",
                    "Less computation"
                ],
                1,
                "Bracketing methods guarantee convergence by maintaining a bracket around the root.",
                "General"
            ),
            createQuestion(
                "How do you verify a root is correct?",
                [
                    "Check iteration count",
                    "Substitute back into function",
                    "Compare methods",
                    "Check derivatives"
                ],
                1,
                "Verifying a root involves substituting it back into the original function to check if f(x) ≈ 0.",
                "General"
            ),
            createQuestion(
                "What determines Bisection Method's stopping point?",
                [
                    "Number of iterations",
                    "Desired accuracy or tolerance",
                    "Function value",
                    "Derivative value"
                ],
                1,
                "Bisection Method stops when the interval width is smaller than the desired tolerance.",
                "General"
            )
        ];

        // Organize questions into sets
        function organizeQuestions() {
            const organized = [];
            for (let setIndex = 0; setIndex < totalSets; setIndex++) {
                const start = setIndex * questionsPerSet;
                const end = start + questionsPerSet;
                organized.push(...allQuestions.slice(start, end));
            }
            return organized;
        }

        // Initialize countdown
        function startCountdown() {
            let count = 10;
            const countdownElement = document.querySelector('.countdown-number');
            const countdownContainer = document.getElementById('countdown-container');
            
            countdownElement.textContent = count;
            
            countdownTimer = setInterval(() => {
                count--;
                countdownElement.textContent = count;
                countdownElement.classList.add('pulse');
                
                setTimeout(() => {
                    countdownElement.classList.remove('pulse');
                }, 500);
                
                if (count <= 0) {
                    clearInterval(countdownTimer);
                    countdownContainer.classList.remove('active');
                    countdownContainer.style.display = 'none';
                    document.getElementById('set-info').style.display = 'block';
                    document.getElementById('question-container').classList.add('active');
                    startQuiz();
                }
            }, 1000);
        }

        // Start quiz
        function startQuiz() {
            currentQuestion = 0;
            score = 0;
            selectedAnswer = null;
            
            // Get questions for current set
            const start = currentSet * questionsPerSet;
            questions = allQuestions.slice(start, start + questionsPerSet);
            
            // Update set info
            document.getElementById('current-set').textContent = currentSet + 1;
            document.getElementById('total-sets').textContent = totalSets;
            
            showQuestion();
            startTimer();
        }

        // Display current question
        function showQuestion() {
            if (currentQuestion >= questions.length) {
                showScore();
                return;
            }

            const question = questions[currentQuestion];
            const questionElement = document.querySelector('.question');
            const optionsContainer = document.querySelector('.options');
            const feedbackElement = document.querySelector('.feedback');
            
            // Clear previous content
            questionElement.textContent = question.question;
            optionsContainer.innerHTML = '';
            feedbackElement.textContent = '';
            feedbackElement.className = 'feedback';
            selectedAnswer = null;
            
            // Create options
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option;
                optionDiv.addEventListener('click', () => selectOption(index));
                optionsContainer.appendChild(optionDiv);
            });
            
            // Update progress
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.querySelector('.progress').style.width = `${progress}%`;
            
            // Reset submit button
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.textContent = 'Submit Answer';
            submitBtn.onclick = checkAnswer;
        }

        // Select an option
        function selectOption(index) {
            // Remove previous selection
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            
            // Add selection to clicked option
            const options = document.querySelectorAll('.option');
            options[index].classList.add('selected');
            selectedAnswer = index;
        }

        // Start timer
        function startTimer() {
            if (timer) {
                clearInterval(timer);
            }
            
            timeLeft = 30;
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    timer = null;
                    checkAnswer();
                }
            }, 1000);
        }

        // Update timer display
        function updateTimerDisplay() {
            const timerElement = document.querySelector('.timer');
            timerElement.textContent = `${timeLeft}s`;
            
            // Add warning colors
            if (timeLeft <= 5) {
                timerElement.className = 'timer danger';
            } else if (timeLeft <= 10) {
                timerElement.className = 'timer warning';
            } else {
                timerElement.className = 'timer';
            }
        }

        // Check answer
        function checkAnswer() {
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            const question = questions[currentQuestion];
            const options = document.querySelectorAll('.option');
            const feedback = document.querySelector('.feedback');
            
            // Disable all options
            options.forEach(option => option.classList.add('disabled'));
            
            // Show correct answer
            options[question.correct].classList.add('correct');
            
            if (selectedAnswer === null) {
                feedback.textContent = "Time's up! No answer selected.";
                feedback.className = 'feedback wrong';
            } else if (selectedAnswer === question.correct) {
                score++;
                feedback.textContent = `Correct! ${question.explanation}`;
                feedback.className = 'feedback correct';
            } else {
                options[selectedAnswer].classList.add('wrong');
                feedback.textContent = `Incorrect. ${question.explanation}`;
                feedback.className = 'feedback wrong';
            }
            
            // Update button
            const submitBtn = document.getElementById('submit-btn');
            if (currentQuestion < questions.length - 1) {
                submitBtn.textContent = 'Next Question';
                submitBtn.onclick = nextQuestion;
            } else {
                submitBtn.textContent = 'Show Score';
                submitBtn.onclick = showScore;
            }
        }

        // Go to next question
        function nextQuestion() {
            currentQuestion++;
            showQuestion();
            startTimer();
        }

        // Show score
        function showScore() {
            document.getElementById('question-container').classList.remove('active');
            const scoreContainer = document.getElementById('score-container');
            scoreContainer.classList.add('active');
            
            const percentage = Math.round((score / questions.length) * 100);
            scoreContainer.querySelector('.score').textContent = `${percentage}%`;
            
            totalScore += score;
            questionsAnswered += questions.length;
            
            let message;
            if (percentage >= 90) message = "Excellent! Keep going!";
            else if (percentage >= 70) message = "Good job! Ready for the next set?";
            else if (percentage >= 50) message = "Not bad! Let's try another set!";
            else message = "Keep practicing! Next set might be better!";
            
            scoreContainer.querySelector('.score-message').textContent = message;
            
            const nextSetBtn = document.getElementById('next-set-btn');
            if (currentSet < totalSets - 1) {
                nextSetBtn.style.display = 'block';
                nextSetBtn.onclick = loadNextSet;
            } else {
                nextSetBtn.style.display = 'none';
                scoreContainer.querySelector('h2').textContent = 'Quiz Complete!';
                const finalScore = Math.round((totalScore / questionsAnswered) * 100);
                scoreContainer.querySelector('.score-message').textContent = 
                    `Final Score: ${finalScore}%\n` + 
                    (finalScore >= 70 ? "Great job! You've mastered Root Finding Methods!" : 
                     "Keep practicing to improve your understanding!");
            }
            
            updateOverallProgress();
        }

        // Load next set
        function loadNextSet() {
            currentSet++;
            document.getElementById('score-container').classList.remove('active');
            document.getElementById('question-container').classList.add('active');
            startQuiz();
        }

        // Update overall progress
        function updateOverallProgress() {
            if (questionsAnswered > 0) {
                const overallProgress = Math.round((totalScore / questionsAnswered) * 100);
                document.getElementById('overall-progress').textContent = overallProgress;
            }
        }

       // Initialize particles.js
        function initParticles() {
            if (typeof particlesJS !== 'undefined') {
                particlesJS('particles-js', {
                    particles: {
                        number: { value: 60, density: { enable: true, value_area: 900 } },
                        color: { value: '#4cd137' },
                        shape: { type: 'circle' },
                        opacity: { value: 0.15, random: true, anim: { enable: true, speed: 1, opacity_min: 0.05 } },
                        size: { value: 3, random: true, anim: { enable: true, speed: 2, size_min: 0.1 } },
                        line_linked: { enable: true, distance: 150, color: '#4cd137', opacity: 0.1, width: 1 },
                        move: { enable: true, speed: 1.5, direction: 'none', random: true, straight: false, out_mode: 'out' }
                    },
                    interactivity: {
                        detect_on: 'canvas',
                        events: { 
                            onhover: { enable: true, mode: 'grab' }, 
                            onclick: { enable: true, mode: 'push' },
                            resize: true
                        },
                        modes: { 
                            grab: { distance: 140, line_linked: { opacity: 0.5 } },
                            push: { particles_nb: 4 }
                        }
                    },
                    retina_detect: true
                });
            }
        }

        // Initialize Lucide icons
        function initLucideIcons() {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        // Show quit confirmation dialog
        function showQuitConfirmation() {
            const dialog = document.getElementById('quit-dialog');
            dialog.classList.add('active');
            
            // Pause any running timers
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            if (countdownTimer) {
                clearInterval(countdownTimer);
                countdownTimer = null;
            }
        }

        // Hide quit confirmation dialog
        function hideQuitConfirmation() {
            const dialog = document.getElementById('quit-dialog');
            dialog.classList.remove('active');
            
            // Resume timer if in quiz
            if (document.getElementById('question-container').classList.contains('active')) {
                startTimer();
            }
            // Resume countdown if in countdown phase
            else if (document.getElementById('countdown-container').classList.contains('active')) {
                startCountdown();
            }
        }

        // Confirm quit and redirect
        function confirmQuit() {
            // Show a brief goodbye message
            const dialog = document.getElementById('quit-dialog');
            const content = dialog.querySelector('.quit-dialog-content');
            
            content.innerHTML = `
                <div class="cute-character">
                    <div class="character-face" style="background: linear-gradient(135deg, #ddd, #bbb);">
                        <div class="eyes">
                            <div class="eye left-eye">
                                <div class="pupil" style="animation: none; transform: scaleY(0.1);"></div>
                            </div>
                            <div class="eye right-eye">
                                <div class="pupil" style="animation: none; transform: scaleY(0.1);"></div>
                            </div>
                        </div>
                        <div class="mouth">
                            <div class="mouth-curve" style="border-radius: 20px 20px 0 0; border-bottom: none; border-top: 2px solid #e17055;"></div>
                        </div>
                    </div>
                    <div class="character-body">
                        <div class="heart">💔</div>
                    </div>
                </div>
                <h3 class="quit-title">Goodbye! 😢</h3>
                <p class="quit-message">
                    Come back anytime! We'll miss you! 💚
                </p>
            `;
            
            // Redirect after a short delay
            setTimeout(() => {
                // Try to go back to the main quiz page or homepage
                if (window.history.length > 1) {
                    window.history.back();
                } else {
                    // If no history, try to go to a main page
                    window.location.href = '../html/index.html';
                }
            }, 2000);
        }

        // Initialize everything when DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            initParticles();
            initLucideIcons();
            startCountdown();
        });

        // Handle page visibility changes
        document.addEventListener('visibilitychange', function() {
            if (document.visibilityState === 'hidden') {
                if (timer) {
                    clearInterval(timer);
                }
                if (countdownTimer) {
                    clearInterval(countdownTimer);
                }
            } else if (document.visibilityState === 'visible') {
                // Resume timers if quiz is active
                if (document.getElementById('question-container').classList.contains('active') && !timer) {
                    startTimer();
                }
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('question-container').classList.contains('active')) {
                // Number keys 1-4 for option selection
                if (e.key >= '1' && e.key <= '4') {
                    const optionIndex = parseInt(e.key) - 1;
                    const options = document.querySelectorAll('.option');
                    if (options[optionIndex] && !options[optionIndex].classList.contains('disabled')) {
                        selectOption(optionIndex);
                    }
                }
                
                // Enter key to submit
                if (e.key === 'Enter') {
                    const submitBtn = document.getElementById('submit-btn');
                    if (submitBtn && submitBtn.style.display !== 'none') {
                        submitBtn.click();
                    }
                }
                
                // Space bar for next question (after answering)
                if (e.key === ' ' && timer === null) {
                    e.preventDefault();
                    const submitBtn = document.getElementById('submit-btn');
                    if (submitBtn.textContent === 'Next Question' || submitBtn.textContent === 'Show Score') {
                        submitBtn.click();
                    }
                }
            }
            
            // Escape key to show quit dialog
            if (e.key === 'Escape') {
                const quitDialog = document.getElementById('quit-dialog');
                if (quitDialog.classList.contains('active')) {
                    hideQuitConfirmation();
                } else {
                    showQuitConfirmation();
                }
            }
        });

        // Add smooth transitions and animations
        function addAnimationEffects() {
            const style = document.createElement('style');
            style.textContent = `
                .question-container.entering {
                    animation: slideInUp 0.5s ease-out;
                }
                
                .question-container.leaving {
                    animation: slideOutDown 0.3s ease-in;
                }
                
                @keyframes slideInUp {
                    from {
                        transform: translateY(30px);
                        opacity: 0;
                    }
                    to {
                        transform: translateY(0);
                        opacity: 1;
                    }
                }
                
                @keyframes slideOutDown {
                    from {
                        transform: translateY(0);
                        opacity: 1;
                    }
                    to {
                        transform: translateY(-30px);
                        opacity: 0;
                    }
                }
                
                .option-enter {
                    animation: optionSlideIn 0.3s ease-out forwards;
                }
                
                @keyframes optionSlideIn {
                    from {
                        transform: translateX(-20px);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
            `;
            document.head.appendChild(style);
        }

        // Enhanced question display with animations
        function showQuestionWithAnimation() {
            const questionContainer = document.getElementById('question-container');
            questionContainer.classList.add('entering');
            
            setTimeout(() => {
                questionContainer.classList.remove('entering');
            }, 500);
            
            // Animate options one by one
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                option.style.animationDelay = `${index * 100}ms`;
                option.classList.add('option-enter');
            });
        }

        // Sound effects (optional - can be enabled if audio files are provided)
        function playSound(type) {
            // Uncomment and add audio files if needed
            /*
            const audio = new Audio();
            switch(type) {
                case 'correct':
                    audio.src = 'sounds/correct.mp3';
                    break;
                case 'wrong':
                    audio.src = 'sounds/wrong.mp3';
                    break;
                case 'tick':
                    audio.src = 'sounds/tick.mp3';
                    break;
            }
            audio.play().catch(e => console.log('Audio play failed:', e));
            */
        }

        // Local storage for progress tracking (if needed in future)
        function saveProgress() {
            const progress = {
                currentSet: currentSet,
                totalScore: totalScore,
                questionsAnswered: questionsAnswered,
                timestamp: Date.now()
            };
            // localStorage.setItem('quizProgress', JSON.stringify(progress));
        }

        function loadProgress() {
            // const saved = localStorage.getItem('quizProgress');
            // if (saved) {
            //     const progress = JSON.parse(saved);
            //     // Restore progress if needed
            // }
        }

        // Performance monitoring
        let performanceMetrics = {
            startTime: null,
            questionTimes: [],
            totalTime: 0
        };

        function trackQuestionTime(questionIndex) {
            const now = Date.now();
            if (performanceMetrics.startTime) {
                const timeSpent = now - performanceMetrics.startTime;
                performanceMetrics.questionTimes[questionIndex] = timeSpent;
            }
            performanceMetrics.startTime = now;
        }

        // Initialize animations
        addAnimationEffects();

        // Add focus management for better accessibility
        function manageFocus() {
            // Focus on first option when question loads
            setTimeout(() => {
                const firstOption = document.querySelector('.option');
                if (firstOption) {
                    firstOption.focus();
                }
            }, 100);
        }

        // Enhanced error handling
        window.addEventListener('error', function(e) {
            console.error('Quiz error:', e.error);
            // Could show user-friendly error message here
        });

        // Prevent accidental page refresh
        window.addEventListener('beforeunload', function(e) {
            if (timer || countdownTimer) {
                e.preventDefault();
                e.returnValue = 'Are you sure you want to leave? Your progress will be lost.';
            }
        });
    </script>
</body>
</html>